== default ==
{
	executable("xD");
	optimization((2.0 + 1.5)@s64 static);
	debug_symbols(true);
	assert(true);
};

static_if(_win32)
{
	WriteConsoleA : func(hConsoleOutput : u64, lpBuffer : u8?, write_count : u32, chars_written : u32 mut? weak, reserved : v0? -> s32) extern;
}
GetStdHandle : func(handle : u32 -> u64) extern;
WriteFile : func(hFile : u64, lpBuffer : u8?, nNumberOfBytesToWrite : u32, chars_written : u32 mut? weak, lpOverlapped : v0? -> s32) extern;

print_sstr : func(str : u8?, len : u64 -> v0)
{
	//static_if(_win32)
	//{
		WriteFile(GetStdHandle(4294967285@u32), str, len@u32, zero, zero);
	//}
};

print_zstr : func(zstr : u8? weak -> v0)
{
	count : u64 mut := 0;
	s : u8? mut := zstr;
	while([s] != 0)
	{
		count = (count + 1);
		s = (s # 1);
	}
	print_sstr(zstr, count);
};

main : func(args : program_args? -> s32)
{
	str ::= "hello world!";
	my_str : u8 mut[13];
	i : u64 mut;
	for i = 0; i < sizeof u8[13]; i = (i + 1);
	{
		[my_str # i] = [str # i];
	}
	[my_str # 3] = 'r';
	print_zstr(my_str # 0);
	return 0;
};
