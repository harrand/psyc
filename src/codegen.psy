mod : u64 mut;
ir : u64 mut;

cg_finish ::= func() -> v0
{
	err : u8& mut;
	LLVMVerifyModule(mod, 0, ref err);
	puts("verify says: ");
	puts(err);
	putchar(10);
};

codegen ::= func(prog : program&) -> v0
{
	puts("test");
	psyc_timed(psyc_stage.codegen);
	mod = LLVMModuleCreateWithName("Psy Program");
	ir = LLVMCreateBuilder();
	
	cg_finish();
};

== build ==
{
	add_source_file("llvm.psy");
	add_source_file("program.psy");
}
